%___________________________________________________________________________________________________________________
% Refer to:
%   https://github.com/pmarcum/WorPT-Work-Plan-Tool-4-proposals/blob/main/latexTableTemplates/[INSERTFILENAME]/readme.md
% for instructions and LaTeX code to copy/paste into your document, to incorporate this file. 
%___________________________________________________________________________________________________________________
% COMMENT: note that the script will strip out any lines that start with "% COMMENT", so 
% COMMENT: these lines will not appear in the final latex files, and are meant primarily 
% COMMENT: to help those who want to alter the github files themselves. 

\def\WorPTfolder{[INSERTFILENAME]} % set the folder name where WorPT files are contained

% ___________________________________________
%       Default formatting preferences
% ___________________________________________

%---- controls width of the left and right columns
\dev\LeftSideWidth{1.5in}          % width of left side column
\dev\RightSideWidth{5.0in}         % width of right side column

%---- appearance of top of each current/pending report showing colorized name banner 
\def\NameBannerColor{Blue}         % Current/Pending top banner color
\def\NameBannerFontColor{White}    % Current/Pending top banner font color
\def\NameBannerBoldface#1{\textbf{#1}} % boldface banner text

%---- appearance of section dividers, eg "Current Support", "Pending Grant Support", etc
\def\SectionColor{lightgray}       % "Current Support" & "Pending Grant Support" color
\def\SectionFontColor{Black}       % "Current Support" and "Pending Grant Support" font color
\def\SectionBoldface#1{\textbf{#1}}% boldface Current Support, Pending Grant Support font

%---- if the WorPT spreadsheet file indicates to do so, a "(this proposal)" appears by
%     the proposal in the "PENDING" list that is the proposal being submitted.  The below
%     controls the font color of that tag
\def\ThisProposalColor{NavyBlue}   % "this proposal" font color in "pending"

%---- controls the font style of the text in the left side of table
\def\LeftBoldface#1{\textbf{#1}}   % boldface left column text

%--- table preamble definition bundled into the "T" variable
\newcolumntype{T}{
  |p{\LeftSideWidth}   % grant descriptors, e.g. "Title", "Source of Support", etc.
  |p{\RightSideWidth}| % right side, giving details for each descriptor
}

\newenvironment{[INSERTFILENAME]}{%
\begin{longtable}{T}   % adjust width and centering

%---- make colorized top name banner
\hline
\multicolumn{2}{|c|}{\cellcolor{\NameBannerColor}\color{\NameBannerFontColor}\NameBannerBoldface{[INSERTNAME] ([INSERTROLE])}}\\ 
\hline

%---- start "CURRENT SUPPORT" section
\multicolumn{2}{|c|}{\cellcolor{\SectionColor}\color{\SectionFontColor}\SectionBoldface{Current Support}}\\
\hline

[INSERTCURRENTFUNDINGENTRIES]

% COMMENT: the script will use one of two formatting options, depending on if there are 
% COMMENT: current grants. Below is what gets written if there is a current grant(s)
% COMMENT: everything between STARTCURRENT and ENDCURRENT will be used as the formatting 
% COMMENT: template for entries in this section
[STARTCURRENT]
%---- next CURRENT SUPPORT entry
\LeftBoldface{Title}&[INSERTCURRENTTITLE]\\ 
\LeftBoldface{Source of Support}&[INSERTCURRENTSOURCE]\\ 
\LeftBoldface{Program POC}&[INSERTCURRENTPOC]\\ 
\LeftBoldface{PI}&[INSERTCURRENTPI]\\
\LeftBoldface{Sci PI}&[INSERTCURRENTSCIPI]\\
\LeftBoldface{Admin PI}&[INSERTCURRENTADMINPI]\\
\LeftBoldface{Award Period}&[INSERTCURRENTAWARDPERIOD]\\
\LeftBoldface{Award Amount}&[INSERTCURRENTDOLLAR]\\
\LeftBoldface{FTE}&[INSERTCURRENTFTES]\\
[ENDCURRENT]

% COMMENT: below is what gets written if there is NO current / ongoing grant support
% COMMENT: everything between STARTNOCURRENT and ENDNOCURRENT will be used as the 
% COMMENT: single entry under this section
[STARTNOCURRENT]
%---- placehold if no current support exists
\LeftBoldface{Title}&\multirow{2}{*}{No grant funding currently}\\
\LeftBoldface{Source of Support}&{}\\
[ENDNOCURRENT]

% COMMENT: below is the banner delineating the Pending Grant section
%---- start "PENDING SUPPORT" section
\hline
\multicolumn{2}{|c|}{\cellcolor{\SectionColor}\color{\SectionFontColor}\SectionBoldface{Pending Grant Support} [INSERTINCLUSIONOPTION]}\\ \hline

% COMMENT: there are 2 optional text to appear in this banner. Below option if user
% COMMENT: indicated current proposal WILL be included in current/pending
[STARTINCLUDECURRENTPROPOSAL]
{(including this proposal)}
[ENDINCLUDECURRENTPROPOSAL]

% COMMENT: there are 2 optional text to appear in this banner. Below option if user
% COMMENT: indicated current proposal should NOT be included in current/pending
[STARTDONOTINCLUDECURRENTPROPOSAL]
{(not including this proposal)}
[ENDDONOTINCLUDECURRENTPROPOSAL]

% COMMENT: below option if user indicated current proposal SHOULD be included;
% COMMENT: proposal is marked with the below tag
[STARTCURRENTPROPOSALMARKER]
{\color{\ThisProposalColor}(this proposal)~~}
[ENDCURRENTPROPOSALMARKER]

[INSERTPENDINGFUNDINGENTRIES]

% COMMENT: under this section are all the pending proposals awaiting review
% COMMENT: the script will use one of two entry options, depending on if there are
% COMMENT: pending proposals. Below is used if there are pending proposals under
% COMMENT: review. Everything between STARTPENDING and ENDPENDING will be used
% COMMENT: as the template for entries under this section
[STARTPENDING]
%---- next PENDING SUPPORT entry
\LeftBoldface{Title}&[INSERTTHISPROPOSALMARKER][INSERTPENDINGTITLE]\\
\LeftBoldface{Source of Support}&[INSERTPENDINGSOURCE]\\
\LeftBoldface{Program POC}&[INSERTPENDINGPOC]\\
\LeftBoldface{PI}&[INSERTPENDINGPI]\\
\LeftBoldface{Sci PI}&[INSERTPENDINGSCIPI]\\
\LeftBoldface{Admin PI}&[INSERTPENDINGADMINPI]\\
\LeftBoldface{Award Period}&[INSERTPENDINGAWARDPERIOD]\\
\LeftBoldface{Award Amount}&[INSERTPENDINGDOLLAR]\\
\LeftBoldface{FTE}&[INSERTPENDINGFTES]\\
[ENDPENDING]

% COMMENT: below is used if there are NO pending proposals
% COMMENT: everything between STARTNOPENDING and ENDNOPENDING will be used as
% COMMENT: single entry under this section
[STARTNOPENDING]
%---- placehold if no pending support exists
\LeftBoldface{Title}&\multirow{2}{*}{No pending grant funding}\\
\LeftBoldface{Source of Support}&{}\\
[ENDNOPENDING]

% COMMENT: the below are 2 options for how each current/pending report is 
% COMMENT: separated from others. If the option that each bio sketch be put
% COMMENT: on a new page (if the purple box above the "biosketch?" column on
% COMMENT: PERSONNEL & FTE page), then use below option. 
[STARTNEWPAGEOPTION]
\n \newpage \n
[ENDNEWPAGEOPTION]

% COMMENT: if the box is not checked, then use this option that writes one bio sketch
% COMMENT: immediately after the other, allowing possibility that a biosketch falls on
% COMMENT: two pages instead of one
[STARTNONEWPAGEOPTION]
\n \bigskip \n
[ENDNONEWPAGEOPTION]

\hline
\end{longtable}
}
{%
}

