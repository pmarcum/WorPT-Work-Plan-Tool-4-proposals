%______________________________________
% Instructions and LaTeX code to copy/paste into your document, to incorporate this file into your proposal, now located at:
%
% https://github.com/pmarcum/WorPT-Work-Plan-Tool-4-proposals/blob/main/latexTableTemplates/[INSERTFILENAME]/readme.md
%______________________________________

%
% Template for WorPT script begins below
% (not for general user unless you are planning to alter the WorPT script!)
%

\def\WorPTfolder{[INSERTFILENAME]} % set the folder name where WorPT files are contained

% ___________________________________________
%       Default formatting preferences
% ___________________________________________

%---- required input from user
\def\ProgramId{HST-xx-xxxxx (Cycle XX)} % user needs to fill in details

%---- column widths and table orientation controls
\def\ContributorWidth{1.8in}      % Contributor column width
\def\PositionWidth{1.3in}         % Position column width
\def\RoleWidth{2.5in}             % Role column width
\def\FundedMemberWidth{0.22in}    % Funded(?) column width
\def\FteWidth{0.42in}             % FTE column width

%--- control to nudge table to the left or right
\def\NudgeTable{1.2\textwidth}   % adjust to help center table

%---- fix the Table Number in the caption
\def\TaskAddCounter{-1}          % corrects table number messed up by table,longtable combination)

%---- table compactness controls
\def\SpaceBetweenRows{1}         % vertical compactness of rows
\def\SpaceBetweenColumns{1pt}    % spacing between columns

%--- aesthetic preferences
\def\HeaderColor{Blue}            % column heading color
\def\LabelColor{White}            % column heading font color
\def\LabelFontstyle#1{\textbf{#1}} % boldface column label
\def\VerticalLineColor{lightgray} % color of vertical lines

%--- internal definitions not to be used as user parameters
\def\AdminPIname{[INSERTADMINPINAME]}
\def\SciencePIname{[INSERTSCIENCEPINAME]}

%--- table preamble definition bundled into the "T" variable
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}
\newcolumntype{T}{
  |L{\ContributorWidth}!{\color{\VerticalLineColor}\vrule} % Contributor column
  L{\PositionWidth}!{\color{\VerticalLineColor}\vrule}     % Position column
  L{\RoleWidth}!{\color{\VerticalLineColor}\vrule}         % Role column
  p{\FundedMemberWidth}!{\color{\VerticalLineColor}\vrule} % Funded(?) column
  p{\FteWidth}|                                            % FTE column
}

\newenvironment{[INSERTFILENAME]}{%
\begin{table}
\addtocounter{table}{\TaskAddCounter}
\centerline{
\renewcommand{\arraystretch}{\SpaceBetweenRows}  % changes vertical space bet/ rows
\setlength{\tabcolsep}{\SpaceBetweenColumns}     % changes horizontal spacing bet/ columns
\begin{minipage}{\NudgeTable}     % increase to nudge table to left
\begin{longtable}{T}

%--- put the required program number and PI(s) at the top
\multicolumn{5}{l}{\textbf{Program \#:} \ProgramId}\\
\multicolumn{5}{l}{\textbf{Program Admin PI:} \AdminPIname}\\
\multicolumn{5}{l}{\textbf{Science PI:} \SciencePIname}\\

%--- make colorized top banner labels, the column headers
\LabelFontstyle{\cellcolor{\HeaderColor}\color{\LabelColor}Contributor} & 
\LabelFontstyle{\cellcolor{\HeaderColor}\color{\LabelColor}Position} \newline{\LabelFontstyle{\cellcolor{\HeaderColor}\color{\LabelColor}Institution} \newline{\LabelFontstyle{\cellcolor{\HeaderColor}\color{\LabelColor}US/Foreign}}} &
\LabelFontstyle{\cellcolor{\HeaderColor}\color{\LabelColor}Role} & 
\LabelFontstyle{\cellcolor{\HeaderColor}\color{\LabelColor}\$?} & 
\LabelFontstyle{\cellcolor{\HeaderColor}\color{\LabelColor}FTE}\\
\hline\hline
%---- start the rows in the table
[INSERTTABLECONTENT]
\hline

% COMMENT: The below template defines the layout of the rows
[STARTROWTEMPLATE]
[INSERTNAME] & [INSERTJOB] & [INSERTDESC] & [INSERTFUNDING] & [INSERTFTE]\hline
[ENDROWTEMPLATE]

\end{longtable}
\end{minipage}}}
{%
\end{table}
}
