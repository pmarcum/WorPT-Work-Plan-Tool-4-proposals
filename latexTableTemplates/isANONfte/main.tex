%___________________________________________________________________________________________________________________
% Refer to:
%   https://github.com/pmarcum/WorPT-Work-Plan-Tool-4-proposals/blob/main/latexTableTemplates/[INSERTFILENAME]/readme.md
% for instructions and LaTeX code to copy/paste into your document, to incorporate this file. 
%___________________________________________________________________________________________________________________

\def\WorPTfolder{[INSERTFILENAME]} % set the folder name where WorPT files are contained

% ___________________________________________
%       Default formatting preferences
% ___________________________________________

%---- fix the Table Number in the caption
\def\TaskAddCounter{-1}          % corrects table number messed up by table,longtable combination)

%---- table compactness controls
\def\SpaceBetweenRows{1}         % vertical compactness of rows
\def\SpaceBetweenColumns{5pt}    % spacing between columns

%--- aesthetic preferences of column headers
\def\RoleLabelFontstyle#1{\textbf{#1}}      % boldface "Role" column label
\def\CommitmentLabelFontstyle#1{\textbf{#1}}% boldface "Commitment (FTE)" column label
\def\YearLabelFontstyle#1{\textbf{#1}}      % boldface "Y1", "Y2", ...  column labels
\def\TotalLabelFontstyle#1{\textbf{#1}}     % boldface "Total" column label

%--- aethetic preferences of colorized banners separating the categories
\def\SectionBannerColor{Blue}              % color of banners separating the 3 sections 
\def\SectionBannerFontColor{White}         % font color of banners separating the 3 sections 
\def\SectionBannerFontstyle#1{\textbf{#1}}  % boldface text in banners separating the 3

%--- aethetic preferences of totals at bottom of each section
\def\TotalWorkEffortFontstyle#1{\textbf{#1}}% boldface text in "Total .... Work Effort" line at section end
\def\TotalWorkEffortFontColor{Blue}        % font color of "Total ... Work Effort" line at section end

%--- internal parameters used by script but not for user
\def\LastYearPlusOne{[INSERTLASTYEARPLUSONE]}

%--- table preamble definition bundled into the "T" variable
\newcolumntype{T}{
  {|l|*{\LastYearPlusOne}{c|}}
}

\newenvironment{[INSERTFILENAME]}{%
\begin{table*}[h!]                              % \begin{table} makes caption have same width as table
\addtocounter{table}{\TaskAddCounter}           % corrects double-counting of longtable and table combination
\renewcommand{\arraystretch}{\SpaceBetweenRows} % controls vertical row separation/spacing
\setlength{\tabcolsep}{\SpaceBetweenColumns}    % controls horizontal column separation/spacing
\begin{longtable}{T}
%--- generate the top column headers
\hline
\multirow{2}{*}{\RoleLabelFontstyle{Role}} & \multicolumn{[INSERTLASTYEARPLUSONE]}{c|}{\CommitmentLabelFontstyle{Commitment (FTE)}}\\

%--- generate the lower column headers
\cline{2-[INSERTLASTYEARPLUSTWO]}
{} & \YearLabelFontstyle{Y1} & \YearLabelFontstyle{Y2} & \YearLabelFontstyle{Y3} & \YearLabelFontstyle{Y4} & \YearLabelFontstyle{Y5} & \YearLabelFontstyle{Y6} & \YearLabelFontstyle{Y7} & \YearLabelFontstyle{Y8} & \YearLabelFontstyle{Y9} & \YearLabelFontstyle{Y10} & \YearTotalFontstyle{Total}\\

%--- banner for the Work Efforts Funded By This Proposal
\multicolumn{[INSERTLASTYEARPLUSTWO]}{|c|}{\cellcolor{\SectionBannerColor}\color{\SectionBannerFontColor}\TaskCategoryFontstyle{Work Efforts To Be Funded By This Proposal}}\\
[INSERTFUNDEDWORKEFFORTLIST]

% COMMENT: template below generates the rows to go under Work Efforts Funded By Proposal section
[STARTFUNDEDTEMPLATE]
[INSERTROLE] & [INSERTY1] & [INSERTY2] & [INSERTY3] & [INSERTY4] & [INSERTY5] & [INSERTY6] & [INSERTY7] & INSERTY8] & [INSERTY9] & [INSERTY10] & [INSERTTOTAL]\\
[ENDFUNDEDTEMPLATE]

% COMMENT: the below is the colorized last line of the section providing sums per year for the funded category
\arrayrulecolor{lightgray!60}\hline\arrayrulecolor{black}
\multicolumn{1}{|l}{\TotalWorkEffortFontstyle{\color{\TotalWorkEffortFontColor}Total Funded Work Effort}} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTFUNDY1]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTFUNDY2]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTFUNDY3]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTFUNDY4]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}INSERTFUNDY5]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTFUNDY6]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTFUNDY7]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTFUNDY8]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTFUNDY9]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTFUNDY10]} & \multicolumn{1}{c|}{\color{\TotalWorkEffortFontColor}[INSERTFUNDTOTAL]}\\

%---- banner for the Work Effort NOT Funded By This Proposal section 
\multicolumn{[INSERTLASTYEARPLUSTWO]}{|c|}{\cellcolor{\SectionBannerColor}\color{\SectionBannerFontColor}\SectionBannerFontstyle{Work Efforts Proposed but NOT Funded By This Proposal}}\\
[INSERTUNFUNDEDWORKEFFORTLIST]

% COMMENT: 2 different template below generate the rows to go under Work Efforts NOT Funded By Proposal section
% COMMENT: if the sum exceeds 0.01 FTE, this template is used
[STARTUNFUNDEDABOVETHRESHOLDTEMPLATE]
% COMMENT: the below template generates a row for each team member under the UNfunded category
[INSERTROLE] & [INSERTY1] & [INSERTY2] & [INSERTY3] & [INSERTY4] & [INSERTY5] & [INSERTY6] & [INSERTY7] & INSERTY8] & [INSERTY9] & [INSERTY10] & [INSERTTOTAL]\\
[ENDUNFUNDEDABOVETHRESHOLDTEMPLATE]

% COMMENT: if the work effor is less than 0.01 FTE, this template is used instead
[STARTUNFUNDEDBELOWTHRESHOLDTEMPLATE]
[INSERTROLE] & \multicolumn{[INSERTLASTYEAR]}{c|}{minor} & {$\leq$0.01}\\
[ENDUNFUNDEDBELOWTHRESHOLDTEMPLATE]

% COMMENT: the below is the colorized last line of the section providing sums per year for the UNfunded category
\arrayrulecolor{lightgray!60}\hline\arrayrulecolor{black}
\multicolumn{1}{|l}{\TotalWorkEffortFontstyle{\color{\TotalWorkEffortFontColor}Total Unfunded Work Effort}} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTUNFUNDY1]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTUNFUNDY2]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTUNFUNDY3]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTUNFUNDY4]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}INSERTUNFUNDY5]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTUNFUNDY6]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTUNFUNDY7]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTUNFUNDY8]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTUNFUNDY9]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTUNFUNDY10]} & \multicolumn{1}{c|}{\color{\TotalWorkEffortFontColor}[INSERTUNFUNDTOTAL]}\\

%--- both FUNDED and UNFUNDED work efforts
\multicolumn{[INSERTLASTYEARPLUSTWO]}{|c|}{\cellcolor{\SectionBannerColor}\color{\SectionBannerFontColor}\SectionBannerFontstyle{Total Work Efforts Proposed (Funded $+$ Unfunded)}}\\
[INSERTBOTHWORKEFFORTLIST]

% COMMENT: the 2 below templates generate a row for each team member under the Funded + UNfunded category
% COMMENT: use this template if the sum effort exceeds 0.01 FTE
[STARTBOTHABOVETHRESHOLDTEMPLATE]
[INSERTROLE] & [INSERTY1] & [INSERTY2] & [INSERTY3] & [INSERTY4] & [INSERTY5] & [INSERTY6] & [INSERTY7] & [INSERTY8] & [INSERTY9] & [INSERTY10] & [INSERTTOTAL]\\
[ENDBOTHABOVETHRESHOLDTEMPLATE]

% COMMENT: or use this template if work effort is less than 0.01 FTE
[STARTBOTHBELOWTHRESHOLDTEMPLATE]
[INSERTROLE] & \multicolumn{[INSERTLASTYEAR]}{c|}{minor} & {$\leq$0.01}\\
[ENDBOTHBELOWTHRESHOLDTEMPLATE]

% COMMENT: the below is the colorized last line of the section providing sums per year for the TOTAL WORK EFFORT category
\arrayrulecolor{lightgray!60}\hline\arrayrulecolor{black}
\multicolumn{1}{|l}{\TotalWorkEffortFontstyle{\color{\TotalWorkEffortFontColor}Total Funded $+$ Unfunded Work Effort}} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTBOTHY1]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTBOTHY2]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTBOTHY3]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTBOTHY4]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTBOTHY5]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTBOTHY6]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTBOTHY7]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTBOTHY8]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTBOTHY9]} & \multicolumn{1}{c}{\color{\TotalWorkEffortFontColor}[INSERTBOTHY10]} & \multicolumn{1}{c|}{\color{\TotalWorkEffortFontColor}[INSERTBOTHTOTAL]}\\
\hline
\end{longtable}
}
{%
\end{table*}
}
